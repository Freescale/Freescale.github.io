<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Freescale Community BSP User Guide 1.6 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="None" href="index.html#document-index" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">Freescale Community BSP User Guide 1.6 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-the-freescale-community-s-bsp-user-guide">
<h1>Welcome to the Freescale Community&#8217;s BSP User Guide!<a class="headerlink" href="#welcome-to-the-freescale-community-s-bsp-user-guide" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-nsteps"></span><div class="section" id="build-and-boot-in-n-steps">
<h2>Build and boot in <em>N</em>-steps<a class="headerlink" href="#build-and-boot-in-n-steps" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Check <a class="reference external" href="https://www.yoctoproject.org/docs/current/yocto-project-qs/yocto-project-qs.html#packages">required host packages</a> for your Linux Distribution</p>
</li>
<li><p class="first">Download the <a class="reference external" href="http://source.android.com/source/downloading.html">repo</a> tool:</p>
<div class="highlight-python"><div class="highlight"><pre>$ mkdir -p ~/bin
$ PATH=~/bin:${PATH}
$ curl http://commondatastorage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo
$ chmod a+x ~/bin/repo
</pre></div>
</div>
</li>
<li><p class="first">Download the Yocto&#8217;s Metadata:</p>
<div class="highlight-python"><div class="highlight"><pre>$ mkdir fsl-community-bsp # You can name it anything you want
$ cd fsl-community-bsp
fsl-community-bsp $ repo init \
                        -u https://github.com/Freescale/fsl-community-bsp-platform \
                        -b jethro
fsl-community-bsp $ repo sync
</pre></div>
</div>
</li>
<li><p class="first">Select your machine (<a class="reference internal" href="index.html#machines"><em>Machines</em></a>) and prepare the environment for bitbake:</p>
<div class="highlight-python"><div class="highlight"><pre>fsl-community-bsp $ MACHINE=&lt;selected machine&gt; source ./setup-environment build
build $
</pre></div>
</div>
</li>
<li><p class="first">Select your image (<a class="reference internal" href="index.html#images"><em>Images</em></a>) and build:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ bitbake-layers show-recipes &quot;*image*&quot; | grep &#39;:&#39;  # To list all possible images
build $ bitbake &lt;selected image&gt;    # Bake! The first time can take several hours
</pre></div>
</div>
</li>
<li><p class="first">Flash your SD card:</p>
<div class="highlight-python"><div class="highlight"><pre># Insert your SD Card
# Type &#39;$ dmesg | tail&#39; to see the device node being used, e.g /dev/sdb
# In case the SD to be flashed has already some partitions, the host system may have
# mounted these, so unmount them, e.g. &#39;$ sudo umount /dev/sdb?&#39;.
build $ ls -la &#39;tmp/deploy/images/&lt;selected machine&gt;/*.sdcard&#39;

# Flash the soft link one
build $ sudo dd if=tmp/deploy/images/&lt;selected machine&gt;/&lt;selected image&gt;-&lt;selected machine&gt;.sdcard \
                of=/dev/sdX \
                bs=1M \
                conv=fsync
</pre></div>
</div>
</li>
<li><p class="first">Place your SD Card in the correct board&#8217;s slot and boot!</p>
</li>
</ol>
<p>Found errors? Subscribe and report it to <a class="reference external" href="https://lists.yoctoproject.org/listinfo/meta-freescale">meta-freescale list</a></p>
</div>
<span id="document-folders"></span><div class="section" id="folders">
<h2>Folders<a class="headerlink" href="#folders" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>fsl-community-bsp</strong>: Base (<tt class="docutils literal"><span class="pre">BASE</span></tt>) directory where all Yocto data reside (recipes, source code, built packages, images, etc.)</li>
<li><strong>BASE/sources</strong>: Source directory where metadata (layers) reside</li>
<li><strong>BASE/build</strong>: Build directory where <tt class="docutils literal"><span class="pre">bitbake</span></tt> commands are executed</li>
<li><strong>BASE/build/tmp</strong>: Target directory for all bitbake commands</li>
<li><strong>BASE/build/tmp/work</strong>: Working directory that holds the task output and source from each recipe</li>
<li><strong>BASE/build/tmp/deploy</strong>: Deploy directory where bitbake&#8217;s deployable output files are copied</li>
<li><strong>BASE/build/tmp/deploy/images</strong>: Complete and partial images are found under this folder</li>
</ul>
</div>
<span id="document-metadata"></span><div class="section" id="metadata">
<h2>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h2>
<p>BitBake handles the parsing and execution of the data files, which consist of various types:</p>
<ul class="simple">
<li><strong>Recipes</strong>: Provides details and build information about particular pieces of software</li>
<li><strong>Classes</strong>: Abstracts common build subroutines and information (e.g. how to build a Linux kernel)</li>
<li><strong>Configuration Data</strong>: Defines machine-specific settings, policy decisions, and so forth.
Configuration data acts as the glue to bind everything together.</li>
</ul>
<div class="section" id="layers">
<h3>Layers<a class="headerlink" href="#layers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Metadata is organized into multiple <tt class="docutils literal"><span class="pre">layers</span></tt>.</li>
<li>Layers allow you to isolate different types of customizations from each other.</li>
<li>DO NOT do your modifications in existing layers, instead create a layer and
create recipes (<tt class="docutils literal"><span class="pre">.bb</span></tt> files) or modify existing ones (<tt class="docutils literal"><span class="pre">.bbappend</span></tt> files)</li>
</ul>
</div>
<div class="section" id="configuration-data">
<h3>Configuration Data<a class="headerlink" href="#configuration-data" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">build/conf/local.conf</span></tt>: Local user configuration for your build environment</li>
<li><tt class="docutils literal"><span class="pre">build/conf/bblayers.conf</span></tt>: Defines layers, which are directory trees,
traversed by BitBake.</li>
<li><tt class="docutils literal"><span class="pre">sources/meta-*/conf/layer.conf</span></tt>: Layer configuration file</li>
<li><tt class="docutils literal"><span class="pre">sources/meta-*/conf/machine/*.conf</span></tt>: Machine configuration files</li>
</ul>
</div>
<div class="section" id="build-s-local-configuration-file-build-conf-local-conf">
<h3>Build&#8217;s local configuration file <tt class="docutils literal"><span class="pre">build/conf/local.conf</span></tt><a class="headerlink" href="#build-s-local-configuration-file-build-conf-local-conf" title="Permalink to this headline">¶</a></h3>
<p>By default, the <tt class="docutils literal"><span class="pre">setup-enviroment</span></tt> script creates a <tt class="docutils literal"><span class="pre">local.conf</span></tt> like this:</p>
<div class="highlight-python"><div class="highlight"><pre>MACHINE ??= &#39;wandboard-dual&#39;
DISTRO ?= &#39;poky&#39;
#PACKAGE_CLASSES ?= &quot;package_rpm&quot;
EXTRA_IMAGE_FEATURES = &quot;debug-tweaks&quot;
USER_CLASSES ?= &quot;buildstats image-mklibs image-prelink&quot;
PATCHRESOLVE = &quot;noop&quot;
BB_DISKMON_DIRS = &quot;\
    STOPTASKS,${TMPDIR},1G,100K \
    STOPTASKS,${DL_DIR},1G,100K \
    STOPTASKS,${SSTATE_DIR},1G,100K \
    ABORT,${TMPDIR},100M,1K \
    ABORT,${DL_DIR},100M,1K \
    ABORT,${SSTATE_DIR},100M,1K&quot;
CONF_VERSION = &quot;1&quot;

BB_NUMBER_THREADS = &#39;4&#39;
PARALLEL_MAKE = &#39;-j 4&#39;
ACCEPT_FSL_EULA = &quot;&quot;
#added by bitbake
DL_DIR = &quot;/home/b42214/fsl-local/yocto/fsl-community-bsp-dylan/downloads/&quot;
#added by bitbake
SSTATE_MIRRORS = &quot;&quot;
#added by bitbake
PACKAGE_CLASSES = &quot;package_rpm&quot;
</pre></div>
</div>
<p>Important variables:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">MACHINE</span></tt>: Specifies the machine, <tt class="docutils literal"><span class="pre">imx6qsabresd</span></tt> is the default</li>
<li><tt class="docutils literal"><span class="pre">BB_NUMBER_THREADS</span></tt> and <tt class="docutils literal"><span class="pre">PARALLEL_MAKE</span></tt>: Specifies the max number of threads when
baking and compiling</li>
<li><tt class="docutils literal"><span class="pre">DL_DIR</span></tt>: Tarball repository. Several users can share the same folder, so data can
be reused.</li>
</ul>
</div>
<div class="section" id="build-s-layer-configuration-file-build-conf-bblayers-conf">
<h3>Build&#8217;s layer configuration file <tt class="docutils literal"><span class="pre">build/conf/bblayers.conf</span></tt><a class="headerlink" href="#build-s-layer-configuration-file-build-conf-bblayers-conf" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Also created by the <tt class="docutils literal"><span class="pre">setup-environment</span></tt> script</p>
</li>
<li><p class="first">In case you need to add a layer, add it to <tt class="docutils literal"><span class="pre">BBLAYERS</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>LCONF_VERSION = &quot;6&quot;

BBPATH = &quot;${TOPDIR}&quot;
BSPDIR := &quot;${@os.path.abspath(os.path.dirname(d.getVar(&#39;FILE&#39;, True)) + &#39;/../..&#39;)}&quot;

BBFILES ?= &quot;&quot;
BBLAYERS = &quot; \
  ${BSPDIR}/sources/poky/meta \
  ${BSPDIR}/sources/poky/meta-yocto \
  \
  ${BSPDIR}/sources/meta-openembedded/meta-oe \
  \
  ${BSPDIR}/sources/meta-fsl-arm \
  ${BSPDIR}/sources/meta-fsl-arm-extra \
  ${BSPDIR}/sources/meta-fsl-demos \
&quot;
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="layer-configuration-file-meta-fsl-arm-conf-layer-conf">
<h3>Layer configuration file <tt class="docutils literal"><span class="pre">meta-fsl-arm/conf/layer.conf</span></tt><a class="headerlink" href="#layer-configuration-file-meta-fsl-arm-conf-layer-conf" title="Permalink to this headline">¶</a></h3>
<p>This is basically a template that specifies the layer&#8217;s name and structure:</p>
<div class="highlight-python"><div class="highlight"><pre># We have a conf and classes directory, add to BBPATH
BBPATH .= &quot;:${LAYERDIR}&quot;

# We have a packages directory, add to BBFILES
BBFILES += &quot;${LAYERDIR}/recipes-*/*/*.bb \
            ${LAYERDIR}/recipes-*/*/*.bbappend&quot;

BBFILE_COLLECTIONS += &quot;fsl-arm&quot;
BBFILE_PATTERN_fsl-arm := &quot;^${LAYERDIR}/&quot;
BBFILE_PRIORITY_fsl-arm = &quot;5&quot;

FSL_EULA_FILE = &quot;${LAYERDIR}/EULA&quot;

FSL_MIRROR ?= &quot;http://www.freescale.com/lgfiles/NMG/MAD/YOCTO/&quot;

MIRRORS += &quot; \
${FSL_MIRROR}       http://download.ossystems.com.br/bsp/freescale/source/ \n \
&quot;
</pre></div>
</div>
<p>Important variables:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">BBFILES</span></tt>: Specifies where BitBake looks for <tt class="docutils literal"><span class="pre">.bb*</span></tt> files</li>
<li><tt class="docutils literal"><span class="pre">BBFILE_PRIORITY_fsl-arm</span></tt>: Specifies priority for recipes in the meta-fsl-arm layer</li>
<li><tt class="docutils literal"><span class="pre">MIRRORS</span></tt>: Specifies additional paths where the build system can find source code</li>
</ul>
</div>
<div class="section" id="machine-configuration-file-meta-fsl-arm-conf-imx6qsabresd-conf">
<h3>Machine configuration file: <tt class="docutils literal"><span class="pre">meta-fsl-arm/conf/imx6qsabresd.conf</span></tt><a class="headerlink" href="#machine-configuration-file-meta-fsl-arm-conf-imx6qsabresd-conf" title="Permalink to this headline">¶</a></h3>
<p>Machine configurations look like this:</p>
<div class="highlight-python"><div class="highlight"><pre>#@TYPE: Machine
#@NAME: i.MX6Q SABRE SD
#@DESCRIPTION: Machine configuration for Freescale i.MX6Q SABRE SD

include conf/machine/include/imx-base.inc
include conf/machine/include/tune-cortexa9.inc

SOC_FAMILY = &quot;mx6:mx6q&quot;

KERNEL_DEVICETREE = &quot;${S}/arch/arm/boot/dts/imx6q-sabresd.dts&quot;

UBOOT_MACHINE = &quot;mx6qsabresd_config&quot;

SERIAL_CONSOLE = &quot;115200 ttymxc0&quot;

MACHINE_FEATURES += &quot; pci wifi bluetooth&quot;
</pre></div>
</div>
<p>Important variables:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">IMAGE_FSTYPES</span></tt>: Located in <a class="reference external" href="http://git.yoctoproject.org/cgit/cgit.cgi/meta-fsl-arm/tree/conf/machine/include/imx-base.inc">imx-base.inc</a>.
Defines the type of outputs for the root filesystem. Default is: <tt class="docutils literal"><span class="pre">&quot;tar.bz2</span> <span class="pre">ext3</span> <span class="pre">sdcard&quot;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">UBOOT_ENTRYPOINT_*</span></tt>: Located in <a class="reference external" href="http://git.yoctoproject.org/cgit/cgit.cgi/meta-fsl-arm/tree/conf/machine/include/imx-base.inc">imx-base.inc</a>.
Defines where the Kernel is loaded by U-boot</li>
<li><tt class="docutils literal"><span class="pre">SOC_FAMILY</span></tt>: Defines the machine&#8217;s family. Only recipes with the same <tt class="docutils literal"><span class="pre">SOC_FAMILY</span></tt> (defined with the recipe&#8217;s variable <tt class="docutils literal"><span class="pre">COMPATIBLE_MACHINE</span></tt>)
are taken into account when baking for a particular machine.</li>
<li><tt class="docutils literal"><span class="pre">UBOOT_MACHINE</span></tt>: Defines the u-boot configuration file</li>
</ul>
</div>
</div>
<span id="document-devtasks"></span><div class="section" id="common-development-tasks">
<h2>Common Development Tasks<a class="headerlink" href="#common-development-tasks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-new-layer">
<span id="new-layer"></span><h3>Creating a new layer<a class="headerlink" href="#creating-a-new-layer" title="Permalink to this headline">¶</a></h3>
<p>Use a custom layer when creating or modifying any metadata file (recipe,
configuration file, or class). The main reason is <strong>modularity</strong>. On the other hand,
make sure your new metadata has not already be implemented (layer, recipe or machine), so
before proceeding check the main <a class="reference external" href="http://layers.openembedded.org/layerindex/layers/">Layer Index</a>.</p>
<ol class="arabic">
<li><p class="first">To have access to Yocto scripts, run the setup environment script under your <tt class="docutils literal"><span class="pre">BASE</span></tt>
directory:</p>
<div class="highlight-python"><div class="highlight"><pre>fsl-community-bsp $ . setup-environment build
</pre></div>
</div>
</li>
<li><p class="first">Move to the place you want to create your layer and choose a name
(e.g. <tt class="docutils literal"><span class="pre">fsl-custom</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre>sources $ yocto-layer create fsl-custom
# Answer the questions. Make sure the priority is set correctly (higher numbers,
# higher priorities). Set the priority equal to the lowest already present, except
# when you create a new recipe with the same name as another recipe and want to shadow
# the original one.
</pre></div>
</div>
</li>
<li><p class="first">Add any metadata content. Suggestion: Version the layer with GIT</p>
</li>
<li><p class="first">Edit and add the layer to the <tt class="docutils literal"><span class="pre">build/conf/bblayers.conf</span></tt> file</p>
</li>
<li><p class="first">To verify that your layer is <cite>seen</cite> by BitBake, run the following command under
the <tt class="docutils literal"><span class="pre">BUILD</span></tt> folder:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ bitbake-layers show-layers
</pre></div>
</div>
</li>
<li><p class="first">You can now include any new image/machine definitions in your layer. If you
created a new recipe and want to include it on your next build, add it to your
<tt class="docutils literal"><span class="pre">build/conf/local.conf</span></tt> file through the <tt class="docutils literal"><span class="pre">CORE_IMAGE_EXTRA_INSTALL</span></tt> variable.</p>
</li>
</ol>
</div>
<div class="section" id="patching-the-linux-kernel">
<span id="patching-kernel"></span><h3>Patching the Linux Kernel<a class="headerlink" href="#patching-the-linux-kernel" title="Permalink to this headline">¶</a></h3>
<p>The Linux Kernel is just another Yocto recipe, so by learning to patch it, you learn
to patch any other package. On the other hand, Yocto <strong>should not</strong> be used for
package development. However, if the need does arise, follow the steps listed below. It is assumed
that you have already built the package you want to patch.</p>
<ul>
<li><p class="first">Create the patch or patches. In this example we are patching the
Linux kernel for <a class="reference external" href="http://www.wandboard.org/">wandboard-dual machine</a>;
in other words, the value of <tt class="docutils literal"><span class="pre">MACHINE</span></tt> in <tt class="docutils literal"><span class="pre">build/conf/local.conf</span></tt> is
<tt class="docutils literal"><span class="pre">MACHINE</span> <span class="pre">??=</span> <span class="pre">'wandboard-dual'</span></tt></p>
</li>
<li><p class="first">If you already have the patches available, make sure they can be applied cleanly with
the commands <tt class="docutils literal"><span class="pre">git</span> <span class="pre">apply</span> <span class="pre">--check</span> <span class="pre">&lt;PATCH_NAME&gt;</span></tt>. To create new or additional patches:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ cd tmp/work/wandboard_dual-poky-linux-gnueabi/linux-wandboard/3.0.35-r0/git
# Edit any files you want to change
$ git add &lt;modified file 1&gt; &lt;modified file 2&gt; ..
$ git commit -s -m &#39;&lt;your commit&#39;s title&gt;&#39;  # Create the commit
$ git format-patch -1                       # Create the patch
</pre></div>
</div>
</li>
<li><p class="first">Create a new layer (see <a class="reference internal" href="index.html#new-layer"><em>Creating a new layer</em></a>)</p>
</li>
<li><p class="first">In the new layer (e.g <tt class="docutils literal"><span class="pre">meta-fsl-custom</span></tt>), create the corresponding sub-directories
and the <tt class="docutils literal"><span class="pre">`.bbfile</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>sources $ mkdir -p \
                   meta-fsl-custom/recipes-kernel/linux/linux-wandboard-3.0.35/
sources $ cat &gt; meta-fsl-custom/recipes-kernel/linux/linux-wandboard_3.0.35.bbappend &lt;&lt; EOF
                FILESEXTRAPATHS_prepend := &quot;${THISDIR}/${PN}-${PV}:&quot;
                SRC_URI += &quot;file://0001-calibrate-Add-printk-example.patch&quot;
                PRINC := &quot;${@int(PRINC) + 1}&quot;
                EOF
</pre></div>
</div>
</li>
<li><p class="first">Move the patch to the new layer:</p>
<div class="highlight-python"><div class="highlight"><pre>sources $ cp ../build/tmp/work/wandboard_dual-poky-linux-gnueabi/linux-wandboard/3.0.35-r0/git/0001-calibrate-Add-printk-example.patch \
             meta-fsl-custom/recipes-kernel/linux/linux-wandboard-3.0.35
</pre></div>
</div>
</li>
<li><p class="first">Setup the environment and clean previous package&#8217;s build data (<tt class="docutils literal"><span class="pre">sstate</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre>fsl-community-bsp $ . setup-environment build
build $ bitbake -c cleansstate linux-wandboard
</pre></div>
</div>
</li>
<li><p class="first">Compile and Deploy:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ bitbake -f -c compile linux-wandboard # -f indicates bitbake to re-execute the compile task
build $ bitbake -c deploy linux-wandboard
</pre></div>
</div>
</li>
<li><p class="first">Insert the SD into your Host and copy the <tt class="docutils literal"><span class="pre">uImage</span></tt> into the first partition.
Do not forget to unmount the partition before removing the card!:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ sudo cp tmp/deploy/images/uImage /media/Boot
</pre></div>
</div>
</li>
<li><p class="first">Insert the SD into your board and test your change.</p>
</li>
</ul>
</div>
<div class="section" id="building-the-kernel-manually">
<span id="building-kernel-manually"></span><h3>Building the Kernel Manually<a class="headerlink" href="#building-the-kernel-manually" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Prepare the Yocto/BitBake environment:</p>
<div class="highlight-python"><div class="highlight"><pre>fsl-community-bsp $ . setup-environment build
</pre></div>
</div>
</li>
<li><p class="first">Build the toolchain:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ bitbake meta-toolchain
# Other toolchains:
#   Qt Embedded toolchain build: bitbake meta-toolchain-qte
#   Qt X11 toolchain build: bitbake meta-toolchain-qt
</pre></div>
</div>
</li>
<li><p class="first">Install it on your PC:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ sudo sh tmp/deploy/sdk/poky-eglibc-x86_64-arm-toolchain-&lt;version&gt;.sh
</pre></div>
</div>
</li>
<li><p class="first">Setup the toolchain environment:</p>
<div class="highlight-python"><div class="highlight"><pre>build $ source /opt/poky/&lt;version&gt;/environment-setup-armv7a-vfp-neon-poky-linux-gnueabi
</pre></div>
</div>
</li>
<li><p class="first">Get the Linux Kernel source code:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone git://git.freescale.com/imx/linux-2.6-imx.git linux-imx
$ cd linux-imx
</pre></div>
</div>
</li>
<li><p class="first">Create a local branch:</p>
<div class="highlight-python"><div class="highlight"><pre>linux-imx $ BRANCH=imx_3.0.35_4.0.0 # Change to any branch you want,
                                    # Use &#39;git branch -a&#39; to list all
linux-imx $ git checkout -b my-${BRANCH} origin/${BRANCH}
</pre></div>
</div>
</li>
<li><p class="first">Define/Export <tt class="docutils literal"><span class="pre">ARCH</span></tt> and <tt class="docutils literal"><span class="pre">CROSS_COMPILE</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>linux-imx $ export ARCH=arm
linux-imx $ export CROSS_COMPILE=arm-poky-linux-gnueabi-
linux-imx $ unset LDFLAGS
</pre></div>
</div>
</li>
<li><p class="first">Choose a configuration and compile:</p>
<div class="highlight-python"><div class="highlight"><pre>linux-imx $ make imx6_defconfig
linux-imx $ make uImage
</pre></div>
</div>
</li>
<li><p class="first">To Test your changes, copy the <tt class="docutils literal"><span class="pre">uImage</span></tt> into your SD Card:</p>
<div class="highlight-python"><div class="highlight"><pre>linux-imx $ sudo cp arch/arm/boot/uImage /media/Boot
</pre></div>
</div>
</li>
<li><p class="first">If you want your changes to be reflected in your Yocto Framework,
create the patches following the subsection <a class="reference internal" href="index.html#patching-kernel"><em>Patching the Linux Kernel</em></a></p>
</li>
</ul>
</div>
<div class="section" id="contributing">
<span id="id1"></span><h3>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h3>
<p>The Yocto Project is open-source, so anyone can contribute. No matter
what your contributions are (bug fixes or new metadata), they should be sent
as patches to the community list. Many eyes will look at your patch, and
at some point it will either be accepted or rejected.</p>
<p>Follow these steps to contribute:</p>
<ul>
<li><p class="first">Make sure you have previously configured your personal info:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git config --global user.name &quot;Your Name Here&quot;
$ git config --global user.email &quot;your_email@example.com&quot;
</pre></div>
</div>
</li>
<li><p class="first">Subscribe to the <a class="reference external" href="https://lists.yoctoproject.org/listinfo/meta-freescale">meta-freescale Mailing List</a></p>
</li>
<li><p class="first">Always base your work on <strong>master</strong> branches:</p>
<div class="highlight-python"><div class="highlight"><pre>fsl-community-bsp $ repo init \
    -u https://github.com/Freescale/fsl-community-bsp-platform \
    -b master
fsl-community-bsp $ repo sync
</pre></div>
</div>
</li>
<li><p class="first">Create local branches so your work is <strong>not</strong> done on master:</p>
<div class="highlight-python"><div class="highlight"><pre>fsl-community-bsp $ repo start &lt;branch name&gt; --all
</pre></div>
</div>
</li>
</ul>
<p>Where <tt class="docutils literal"><span class="pre">&lt;branch</span> <span class="pre">name&gt;</span></tt> is any name you want to give to your local branch (e.g.
<tt class="docutils literal"><span class="pre">fix_uboot_recipe</span></tt>, <tt class="docutils literal"><span class="pre">new_gstreamer_recipe</span></tt>, etc.)</p>
<ul>
<li><p class="first">Make your changes in any Freescale related folder (e.g. <tt class="docutils literal"><span class="pre">sources/meta-fsl-arm</span></tt>).
In case you modified a recipe (.bb) or include (.inc) file, do not forget to <cite>bump</cite>
(increase the value by one) either the <tt class="docutils literal"><span class="pre">PR</span></tt> or <tt class="docutils literal"><span class="pre">INC_PR</span></tt> value</p>
</li>
<li><p class="first">Commit your changes using <cite>GIT</cite>. In this example we assume your change is on <tt class="docutils literal"><span class="pre">meta-fsl-arm</span></tt> folder:</p>
<div class="highlight-python"><div class="highlight"><pre>sources/meta-fsl-arm $ git add &lt;file 1&gt; &lt;file 2&gt;
sources/meta-fsl-arm $ git commit
</pre></div>
</div>
</li>
</ul>
<p>In the commit&#8217;s log, the title must start with the filename that was changed or created,
followed by a brief description of the patch&#8217;s goal. On subsequent lines, provide a thorough description of the changes.
Make sure you follow the standards (type ` git log &#8211;pretty=oneline` to see previous commits)</p>
<ul>
<li><p class="first">Create a patch:</p>
<div class="highlight-python"><div class="highlight"><pre>sources/meta-fsl-arm $ git format-patch -s --subject-prefix=&#39;&lt;meta-fsl-arm][PATCH&#39; -1
</pre></div>
</div>
</li>
</ul>
<p>Where the last parameter (<tt class="docutils literal"><span class="pre">-1</span></tt>) indicate to patch the last commit.
In case you want to create patches for older commits, just indicate the correct index.
If your patch is done in another folder, just make sure you change the <cite>&#8211;subject-prefix</cite> value.</p>
<ul>
<li><p class="first">Send your patch or patches with:</p>
<div class="highlight-python"><div class="highlight"><pre>git send-email --to meta-freescale@yoctoproject.org &lt;patch&gt;
</pre></div>
</div>
</li>
</ul>
<p>where <tt class="docutils literal"><span class="pre">&lt;patch&gt;</span></tt> is the file created by <tt class="docutils literal"><span class="pre">git</span> <span class="pre">format-patch</span></tt>.</p>
<ul>
<li><p class="first">Keep track of patch responses on the mailing list. In case you need to rework your patch,
repeat the steps but this time change the patch&#8217;s subject to
<tt class="docutils literal"><span class="pre">--subject-prefix='&lt;meta-fsl-*][PATCH</span> <span class="pre">v2'</span></tt></p>
</li>
<li><p class="first">Once your patch has been approved, you can delete your working branches:</p>
<div class="highlight-python"><div class="highlight"><pre>fsl-community-bsp $ repo abandon &lt;branch name&gt;
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<span id="document-weston"></span><div class="section" id="weston">
<h2>Weston<a class="headerlink" href="#weston" title="Permalink to this headline">¶</a></h2>
<p>In order to test Weston, the reference implementation of a Wayland compositor, use the image <em>core-image-weston</em></p>
<p>Add the following to conf/local.conf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DISTRO_FEATURES_remove</span> <span class="o">=</span> <span class="s">&quot;x11&quot;</span>
</pre></div>
</div>
<p>And bake the image:</p>
<div class="highlight-python"><div class="highlight"><pre>$ bitbake core-image-weston
</pre></div>
</div>
<p>Remember to use a clean build-dir when changing <cite>DISTRO_FEATURES</cite></p>
<div class="section" id="simple-tests">
<h3>Simple tests<a class="headerlink" href="#simple-tests" title="Permalink to this headline">¶</a></h3>
<p>In order to access Weston examples via a console:</p>
<div class="highlight-python"><div class="highlight"><pre>$ export XDG_RUNTIME_DIR=/var/run/user/root
$ weston-simple-shm =&gt; basic wayland example
$ weston-simple-egl =&gt; basic wayland example. To make sure egl integration works fine
$ weston-terminal =&gt; To make sure cairo integration works fine.
</pre></div>
</div>
</div>
<div class="section" id="enabling-multibuffering">
<h3>Enabling multibuffering<a class="headerlink" href="#enabling-multibuffering" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>$ export FB_MULTI_BUFFER=2
$ /etc/init.d/weston restart
</pre></div>
</div>
<p>How to start with <cite>gal2d</cite> compositor:</p>
<div class="highlight-python"><div class="highlight"><pre>$ /etc/init.d/weston stop
$ weston –tty=1 –use-gl=0 –use-gal2d=1 &amp;
</pre></div>
</div>
<p>Using Multi (extended) display, make sure <cite>/dev/fb0</cite> and <cite>/dev/fb1</cite> has
same color depth:</p>
<div class="highlight-python"><div class="highlight"><pre>$ /etc/init.d/weston stop
$ weston –tty=1 –use-gl=0 –use-gal2d=1 –device=”dev/fb0,/dev/fb2” &amp;
</pre></div>
</div>
<p>Using QT5, need to build meta-qt5 with qtwayland package. Then run
with:</p>
<div class="highlight-python"><div class="highlight"><pre>$ hellogl_es2 –platform wayland-egl
</pre></div>
</div>
</div>
</div>
<span id="document-machines"></span><div class="section" id="machines">
<span id="id1"></span><h2>Machines<a class="headerlink" href="#machines" title="Permalink to this headline">¶</a></h2>
<p>The scope of this release includes both meta-fsl-arm and meta-fsl-arm-extra.
Please refer to the table below for the complete list of supported boards.</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="49%" />
<col width="10%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Machine</th>
<th class="head">Name</th>
<th class="head">SoC</th>
<th class="head">Layer</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>imx6qsabrelite</td>
<td>Boundary Devices i.MX6Q SABRE Lite</td>
<td>i.MX6Q</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>nitrogen6x</td>
<td>Boundary Devices Nitrogen6X</td>
<td>i.MX6Q</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>nitrogen6x-lite</td>
<td>Boundary Devices Nitrogen6X Lite</td>
<td>i.MX6 Solo</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>cgtqmx6</td>
<td>Congatec Qmx6</td>
<td>i.MX6Q</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>cfa10036</td>
<td>Crystalfontz CFA-10036</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>cfa10037</td>
<td>Crystalfontz CFA-10037</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>cfa10049</td>
<td>Crystalfontz CFA-10049</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>cfa10055</td>
<td>Crystalfontz CFA-10055</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>cfa10056</td>
<td>Crystalfontz CFA-10056</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>cfa10057</td>
<td>Crystalfontz CFA-10057</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>cfa10058</td>
<td>Crystalfontz CFA-10058</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>m28evk</td>
<td>DENX M28 SoM Evaluation Kit</td>
<td>i.MX28</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>m53evk</td>
<td>DENX M53 SoM Evaluation Kit</td>
<td>i.MX53</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>imx23evk</td>
<td>Freescale i.MX23 Evaluation Kit</td>
<td>i.MX23</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx28evk</td>
<td>Freescale i.MX28 Evaluation Kit</td>
<td>i.MX28</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-odd"><td>imx31pdk</td>
<td>Freescale i.MX31 Platform Development Kit</td>
<td>i.MX31</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx35pdk</td>
<td>Freescale i.MX35 Platform Development Kit</td>
<td>i.MX35</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-odd"><td>imx51evk</td>
<td>Freescale i.MX51 Evaluation Kit</td>
<td>i.MX51</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx53qsb</td>
<td>Freescale i.MX53 Quick Start Board</td>
<td>i.MX53</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-odd"><td>imx53ard</td>
<td>Freescale i.MX53 SABRE Automotive Board</td>
<td>i.MX53</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx6dlsabreauto</td>
<td>Freescale i.MX6DL SABRE Automotive</td>
<td>i.MX6DL</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-odd"><td>imx6dlsabresd</td>
<td>Freescale i.MX6DL SABRE Smart Device</td>
<td>i.MX6DL</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx6qsabreauto</td>
<td>Freescale i.MX6Q SABRE Automotive</td>
<td>i.MX6Q</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-odd"><td>imx6qsabresd</td>
<td>Freescale i.MX6Q SABRE Smart Device</td>
<td>i.MX6Q</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx6slevk</td>
<td>Freescale i.MX6SL Evaluation Kit</td>
<td>i.MX6SL</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-odd"><td>imx6solosabreauto</td>
<td>Freescale i.MX6Solo SABRE Automotive</td>
<td>i.MX6S</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx6solosabresd</td>
<td>Freescale i.MX6Solo SABRE Smart Device</td>
<td>i.MX6S</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-odd"><td>twr-vf65gs10</td>
<td>Freescale Vybrid TWR-VF65GS10</td>
<td>vf60</td>
<td>meta-fsl-arm</td>
</tr>
<tr class="row-even"><td>imx233-olinuxino-maxi</td>
<td>OLIMEX iMX233-OLinuXino-Maxi</td>
<td>i.MX23</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>imx233-olinuxino-micro</td>
<td>OLIMEX iMX233-OLinuXino-Micro</td>
<td>i.MX23</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>imx233-olinuxino-mini</td>
<td>OLIMEX iMX233-OLinuXino-Mini</td>
<td>i.MX23</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>imx233-olinuxino-nano</td>
<td>OLIMEX iMX233-OLinuXino-Nano</td>
<td>i.MX23</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>wandboard-dual</td>
<td>Wandboard i.MX6 Wandboard Duallite</td>
<td>i.MX6DL</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-odd"><td>wandboard-quad</td>
<td>Wandboard i.MX6 Wandboard Quad</td>
<td>i.MX6Q</td>
<td>meta-fsl-arm-extra</td>
</tr>
<tr class="row-even"><td>wandboard-solo</td>
<td>Wandboard i.MX6 Wandboard Solo</td>
<td>i.MX6S</td>
<td>meta-fsl-arm-extra</td>
</tr>
</tbody>
</table>
</div>
<span id="document-images"></span><div class="section" id="images">
<span id="id1"></span><h2>Images<a class="headerlink" href="#images" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>fsl-image-machine-test</strong>: A console-only image that includes gstreamer packages, Freescale&#8217;s multimedia packages (VPU and GPU) when available, and test and benchmark applications.</li>
<li><strong>fsl-image-mfgtool-initramfs</strong>: Small image to be used with Manufacturing Tool (mfg-tool) in a production environment.</li>
<li><strong>fsl-image-multimedia</strong>: A console-only image that includes gstreamer packages and Freescale&#8217;s multimedia packages (VPU and GPU) when available for the specific machine.</li>
<li><strong>fsl-image-multimedia-full</strong>: A console-only image that includes gstreamer packages and Freescale&#8217;s multimedia packages (VPU and GPU) when available for the specific machine.</li>
<li><strong>qt-in-use-image</strong>: qt-in-use-image version 1.0-r0.</li>
<li><strong>qte-in-use-image</strong>: qte-in-use-image version 1.0-r0.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html#document-index">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-nsteps">Build and boot in <em>N</em>-steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-folders">Folders</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-metadata">Metadata</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#configuration-data">Configuration Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#build-s-local-configuration-file-build-conf-local-conf">Build&#8217;s local configuration file <tt class="docutils literal"><span class="pre">build/conf/local.conf</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#build-s-layer-configuration-file-build-conf-bblayers-conf">Build&#8217;s layer configuration file <tt class="docutils literal"><span class="pre">build/conf/bblayers.conf</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#layer-configuration-file-meta-fsl-arm-conf-layer-conf">Layer configuration file <tt class="docutils literal"><span class="pre">meta-fsl-arm/conf/layer.conf</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#machine-configuration-file-meta-fsl-arm-conf-imx6qsabresd-conf">Machine configuration file: <tt class="docutils literal"><span class="pre">meta-fsl-arm/conf/imx6qsabresd.conf</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-devtasks">Common Development Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#creating-a-new-layer">Creating a new layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#patching-the-linux-kernel">Patching the Linux Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#building-the-kernel-manually">Building the Kernel Manually</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#contributing">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-weston">Weston</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#simple-tests">Simple tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#enabling-multibuffering">Enabling multibuffering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-machines">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-images">Images</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">Freescale Community BSP User Guide 1.6 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Freescale Community BSP Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>